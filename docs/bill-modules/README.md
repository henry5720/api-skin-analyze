# 報帳模組 (TS)

> 用於發票上傳、OCR 識別、報帳管理與報表匯出的整合模組

## 功能概述

本模組提供完整的報帳流程管理，包含：
- 📤 發票上傳功能
- 🔍 OCR 自動識別發票資訊
- ✏️ 報帳資料編輯與管理
- 📊 報表匯出功能

## 使用情境流程

### 線上操作環境demo
建議使用手機版操作：[線上展示環境, 僅參考流程](https://zp1v56uxy8rdx5ypatb0ockcb9tr6a-oci3--5173--6e337437.local-credentialless.webcontainer-api.io/)

### 操作步驟
1. **新增報帳記錄**
   - 點擊「新增報帳」按鈕
   - 選擇識別方式（預設啟用OCR）
   
2. **OCR自動識別模式**（啟用OCR開關）
   - 上傳發票圖片（支援多種格式）
   - 系統自動識別發票資訊
   - 修正並確認識別結果
   
3. **手動填寫模式**（關閉OCR開關）
   - 直接填寫報帳表單
   - 手動輸入所有必要資訊
   
4. **上傳附加檔案**（可選）
   - 點擊「選擇檔案」或拖拽檔案至上傳區域
   - 支援上傳收據、證明文件等
   - 可預覽並管理已選擇的檔案
   
5. **資料驗證與儲存**
   - 驗證表單資料完整性
   - 儲存至後端系統
   
6. **報表匯出**
   - 匯出 Excel 報表
   - 支援多種報表格式

### 新增流程特色
- **靈活選擇**：可選擇OCR自動識別或手動填寫
- **預設啟用**：OCR開關預設開啟，適合大部分使用情境
- **便捷操作**：無發票時可直接手動填寫，節省時間
- **多檔案支援**：可上傳收據、證明文件等附加檔案
- **檔案預覽**：支援多種檔案格式預覽與管理
- **拖拽上傳**：支援檔案拖拽上傳，操作更便捷

### 支援的檔案格式
- **圖片格式**：JPG、PNG、GIF、BMP、WebP
- **文件格式**：PDF、DOC、DOCX
- **上傳方式**：
  - 點擊按鈕選擇檔案
  - 拖拽檔案至上傳區域
  - 支援多檔案同時上傳

### 檔案管理功能
- **即時預覽**：選擇檔案後立即顯示預覽
- **檔案資訊**：顯示檔案名稱、大小、類型圖示
- **移除功能**：可個別移除已選擇的檔案
- **視覺化管理**：清楚的檔案列表與操作按鈕
- **表格顯示**：在報帳記錄中顯示附加檔案圖示
- **編輯支援**：編輯記錄時可新增或更新附加檔案

## UI 介面設計 (未定: 依使用情境選取, 或是可以切換?)

### 模式一：專案管理模式
適用於以專案為單位的報帳管理

**特色：**
- 左側邊欄顯示專案列表（每次報帳建立一個專案）
- 主要內容區域使用表格呈現報帳詳細資訊

![專案管理模式](./assets/ui-mode-1.png)

### 模式二：日期管理模式
適用於以時間為單位的報帳管理

**特色：**
- 主要內容區域使用日曆檢視
- 右側邊欄顯示單筆報帳詳細資訊

![日期管理模式 - 日曆檢視](./assets/ui-mode-2.1.png)
![日期管理模式 - 詳細資訊](./assets/ui-mode-2.2.png)

> **注意：** UI 模式尚未確定，將根據實際使用情境決定或提供可切換選項，並保持與現有設計系統的一致性。

## 進階功能

### 金額處理
- **幣別轉換**：支援多種幣別自動換算
- **匯率更新**：即時匯率資料同步

### 資料分析
- **專案分析**：依專案別統計支出
- **價格分析**：支出趨勢與分佈分析
- **時間分析**：依時間區間統計報表

### 其他功能
- 批次處理功能
- 自動備份機制
- 稽核軌跡記錄

## 技術規格

- **前端框架**：TypeScript
- **後端整合**：支援 RESTful API
- **檔案處理**：支援多種圖片格式
- **匯出格式**：Excel、PDF、CSV

---

*最後更新：2024*
